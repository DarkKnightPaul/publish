!function(e){window.MyAppConfig={name:"myapp",title:"演示样板项目"};var o=angular.module(MyAppConfig.name,["ngRoute","ngCookies","ngSanitize","ngAnimate","ngMessages","controllers","services","directives"]);angular.module("controllers",[]),angular.module("services",[]),angular.module("directives",[]),o.config(["$logProvider",function(e){e.debugEnabled(!0)}]),o.config(["$httpProvider",function(e){e.defaults.headers.post["Content-Type"]="application/x-www-form-urlencoded;charset=utf-8";var o=function(e){var t,n,i,a,l,r,d="";for(t in e)if((n=e[t])instanceof Array)for(r=0;r<n.length;r++)a=n[r],(l={})[t+"["+r+"]"]=a,d+=o(l)+"&";else if(n instanceof Object)for(i in n)a=n[i],(l={})[t+"."+i]=a,d+=o(l)+"&";else void 0!==n&&null!==n&&(d+=encodeURIComponent(t)+"="+encodeURIComponent(n)+"&");return d.length?d.substr(0,d.length-1):d};e.defaults.transformRequest=[function(e){return angular.isObject(e)&&"[object File]"!==String(e)?o(e):e}],e.interceptors.push(["$q","$log","$location",function(e,o,t){return{responseError:function(n){return o.debug("应答发生错误：",n),"templates"==n.config.url.substr(0,9)&&(o.debug("模板页不存在==>",n.config.url),t.path("/")),e.reject(n)}}}])}]),o.config(["$routeProvider",function(e){e.when("",{redirectTo:"/route/page/index"}).when("/",{redirectTo:"/route/page/index"}).when("/index",{redirectTo:"/route/page/index"}).when("/route/:path*",{templateUrl:"templates/route.html"}).otherwise({redirectTo:"/route/page/index"})}])}(),function(){angular.module("services").factory("DataService",["$log","$http",function(e,o){e.info("DataService init...");var t="",n={};return n.setServer=function(e){t=e},n.send=function(n,i,a){i.ajaxtimestamp=(new Date).getTime(),o({method:"POST",url:t+n,data:i}).then(function(o,t){e.debug("DataService.data:",o.data),(a||angular.noop)(null,o.data)},function(o,t){e.error("DataService.send error:",o),(a||angular.noop)(o,null)})},n}])}(),function(){angular.module("services").factory("DialogService",["$rootScope","$log","$timeout",function(e,o,t){o.info("DialogService init...");var n={},i="信息";n.setDialogTitle=function(e){i=e};var a=null;n.setTempDialogTitle=function(e){a=e};var l=null;n.setAlertBtnOk=function(e){l=e};var r={closefn:angular.noop,hasinit:!1};n.setAlertDialog=function(e){o.debug("DialogService.setAlertDialog==>",e),r.scope=e.scope,r.element=e.element,r.element.on("hidden.bs.modal",function(){var e=r.closefn;r.closefn=angular.noop,e()}),r.hasinit=!0},n.showAlertDialog=function(e,n){r.hasinit?t(function(){r.closefn=n||angular.noop,r.scope.alertInfo=e,r.scope.alertTitle=a||i,r.scope.alertBtnOk=l||"确定",a=null,l=null,r.element.modal("show")}):o.debug("DialogService.showAlertDialog not init...")},n.hideAlertDialog=function(){r.element.modal("hide")};var d={closefn:angular.noop,hasinit:!1};n.setWaitDialog=function(e){o.debug("DialogService.setWaitDialog==>",e),d.scope=e.scope,d.element=e.element,d.element.on("hidden.bs.modal",function(){var e=d.closefn;d.closefn=angular.noop,e()}),d.hasinit=!0},n.showWaitDialog=function(e,n){d.hasinit?t(function(){d.closefn=n||angular.noop,d.scope.waitInfo=e,d.scope.waitTitle=a||i,a=null,d.element.modal("show")}):o.debug("DialogService.showWaitDialog not init...")},n.hideWaitDialog=function(){d.element.modal("hide")};var c=null,s=null;n.setConfirmBtnYes=function(e){c=e},n.setConfirmBtnNo=function(e){s=e};var u={yesfn:angular.noop,nofn:angular.noop,choose:"no",hasinit:!1};n.setConfirmDialog=function(e){o.debug("DialogService.setConfirmDialog==>",e),u.scope=e.scope,u.element=e.element,u.hasinit=!0},n.showConfirmDialog=function(e,n,l){u.hasinit?t(function(){u.yesfn=n||angular.noop,u.nofn=l||angular.noop,u.scope.confirmInfo=e,u.scope.confirmTitle=a||i,a=null,r.scope.confirmBtnYes=c||"确定",r.scope.confirmBtnNo=s||"取消",c=null,s=null,u.element.on("hidden.bs.modal",function(){var e="no"==u.choose?u.nofn:u.yesfn;u.choose="no",u.nofn=angular.noop,u.yesfn=angular.noop,e()}),u.element.modal("show")}):o.debug("DialogService.showConfirmDialog not init...")},n.hideConfirmDialog=function(){u.element.modal("hide")},n.confirmOk=function(){u.choose="yes",n.hideConfirmDialog()},n.confirmCancel=function(){u.choose="no",n.hideConfirmDialog()};var g={closefn:angular.noop,hasinit:!1,data:{}};return n.setCustomDialog=function(e){o.debug("DialogService.setCustomDialog==>",e),g.scope=e.scope,g.element=e.element,g.element.on("hidden.bs.modal",function(){var e=g.closefn;g.closefn=angular.noop,e()}),g.hasinit=!0},n.showCustomDialog=function(e,n,l){g.hasinit?t(function(){g.scope.customPage=e,e="",g.data=n||{},g.closefn=l||angular.noop,g.scope.customTitle=a||i,a=null,g.element.modal("show")}):o.debug("DialogService.showCustomDialog not init...")},n.hideCustomDialog=function(){g.element.modal("hide")},n.getCustomData=function(){var e=g.data;return g.data={},e},n}])}(),function(){angular.module("services").factory("UtilService",["$log",function(e){var o={},t=["星期日","星期一","星期二","星期三","星期四","星期五","星期六"];return o.formatDate=function(e,o){var n=new Date;e&&n.setTime(e),o||(o="y-M-d h:m:s");var i=n.getFullYear(),a=n.getMonth()+1,l=n.getDate(),r=n.getHours(),d=n.getMinutes(),c=n.getSeconds(),s=n.getDay();a=a<10?"0"+a:""+a,l=l<10?"0"+l:""+l,r=r<10?"0"+r:""+r,d=d<10?"0"+d:""+d,c=c<10?"0"+c:""+c,s=t[s];var u=o.replace("y",i);return u=(u=(u=(u=(u=(u=u.replace("M",a)).replace("d",l)).replace("h",r)).replace("m",d)).replace("s",c)).replace("w",s)},o}])}(),function(){var e=angular.module("directives");e.directive("alertDialog",["$log","DialogService",function(e,o){return e.debug("directive alert-dialog..."),{restrict:"AE",template:"<div class='modal' data-backdrop='static' data-keyboard='false' tabindex='-1' role='dialog' style='z-index: 1990;'>    <div class='modal-dialog modal-sm' role='document'>        <div class='modal-content'>            <div class='modal-header'>                <button type='button' class='close' data-dismiss='modal' aria-label='Close'>                    <span aria-hidden='true'>&times;</span>                </button>                <h4 class='modal-title' ng-bind='alertTitle'></h4>            </div>            <div class='modal-body'>                <div ng-bind-html='alertInfo'></div>            </div>            <div class='modal-footer'>                <button type='button' class='btn btn-default' data-dismiss='modal' ng-bind-html='alertBtnOk'></button>            </div>        </div>    </div></div>",replace:!0,link:function(t,n,i){t.$on("$destroy",function(){e.debug("directive alert-dialog destroy...")}),e.debug("directive alert-dialog init==>",n),o.setAlertDialog({scope:t,element:n})}}}]);e.directive("waitDialog",["$log","DialogService",function(e,o){return e.debug("directive wait-dialog..."),{restrict:"AE",template:"<div class='modal' data-backdrop='static' data-keyboard='false' tabindex='-1' role='dialog' style='z-index: 2000;'>    <div class='modal-dialog modal-sm' role='document'>        <div class='modal-content'>            <div class='modal-header'>                <div class='modal-title' ng-bind='waitTitle'></div>            </div>            <div class='modal-body'>                <div class='text-center'>                    <span ng-bind-html='waitInfo'></span>                </div>            </div>        </div>    </div></div>",replace:!0,link:function(t,n,i){t.$on("$destroy",function(){e.debug("directive wait-dialog destroy...")}),e.debug("directive wait-dialog init==>",n),o.setWaitDialog({scope:t,element:n})}}}]);e.directive("customDialog",["$log","DialogService",function(e,o){return e.debug("directive custom-dialog..."),{restrict:"AE",template:"<div class='modal' data-backdrop='static' data-keyboard='false' tabindex='-1' role='dialog' style='z-index: 1500;'>    <div class='modal-dialog' role='document'>        <div class='modal-content'>            <div class='modal-header'>                <div class='modal-title' ng-bind='customTitle'></div>            </div>            <div class='modal-body'>                <div ng-include='customPage'></div>            </div>        </div>    </div></div>",replace:!0,link:function(t,n,i){t.$on("$destroy",function(){e.debug("directive custom-dialog destroy...")}),e.debug("directive custom-dialog init==>",n),o.setCustomDialog({scope:t,element:n})}}}]);e.directive("confirmDialog",["$log","DialogService",function(e,o){return e.debug("directive confirm-dialog..."),{restrict:"AE",template:"<div class='modal' data-backdrop='static' data-keyboard='false' tabindex='-1' role='dialog' style='z-index: 1990;'>    <div class='modal-dialog modal-sm' role='document'>        <div class='modal-content'>            <div class='modal-header'>                <h4 class='modal-title' ng-bind='confirmTitle'></h4>            </div>            <div class='modal-body'>                <p ng-bind-html='confirmInfo'></p>            </div>            <div class='modal-footer'>                <button type='button' class='btn btn-default' ng-click='confirmOk()'  ng-bind-html='confirmBtnYes'></button>                <button type='button' class='btn btn-default' ng-click='confirmCancel()' ng-bind-html='confirmBtnNo'></button>            </div>        </div>    </div></div>",replace:!0,link:function(t,n,i){t.$on("$destroy",function(){e.debug("directive confirm-dialog destroy...")}),e.debug("directive confirm-dialog init==>",n),o.setConfirmDialog({scope:t,element:n}),t.confirmOk=o.confirmOk,t.confirmCancel=o.confirmCancel}}}])}(),angular.module("directives").directive("formatDate",["$log","UtilService",function(e,o){return e.debug("format-date init..."),{scope:{formatDate:"@"},link:function(t,n,i){e.debug("format-date date:",t.formatDate);var a=t.$watch("formatDate",function(t,i){e.debug("format-date watch:",t),ts=parseInt(t.replace("/^D/g","")),n.html(o.formatDate(ts,"y-M-d h:m:s w"))});t.$on("$destroy",function(){e.debug("format-date destroy..."),a()})}}}]),function(){angular.module("controllers").controller("IndexCtrl",["$scope","$log","$timeout","DialogService","DataService",function(e,o,t,n,i){o.debug("IndexCtrl init..."),e.$on("$destroy",function(){o.debug("IndexCtrl destroy...")}),n.showConfirmDialog("是否测试获取服务器数据，需要开启后台项目",function(){n.showWaitDialog("等待处理完毕..."),i.setServer("http://127.0.0.1:10000"),i.send("/demo/echo",{test:{tid:100}},function(e,t){n.hideWaitDialog(),o.debug(e,t)})},function(){n.showAlertDialog("没有获取后台数据")})}])}(),function(){angular.module("controllers").controller("RootCtrl",["$rootScope","$scope","$log","$location",function(e,o,t,n){t.debug("RootCtrl init...",n.path()),o.$on("$destroy",function(){t.debug("RootCtrl destroy...")}),e.$on("$routeChangeStart",function(e,o,n){t.debug("route加载页面中：",o,"-",n,"[event]",e)}),e.$on("$routeChangeSuccess",function(e,o,n){t.debug("route加载完毕。。。",o,"-",n,"[event]",e)}),e.$on("$routeChangeError",function(e,o){t.debug("route加载错误。。。",o,"[event]",e)})}])}(),function(){angular.module("controllers").controller("RouteCtrl",["$scope","$log","$routeParams","$location",function(n,i,a,l){i.debug("RouteCtrl $routeParams:",a.path),n.$on("$destroy",function(){i.debug("RouteCtrl destroy...")}),n.init=function(){var l=a.path.replace(e,"");i.debug("RouteCtrl init...",l),n.template=o+l+t+"?pagetimestamp="+(new Date).getTime(),i.debug("RouteCtrl template:",n.template)},n.init()}]);var e="page/",o="templates/",t=".html"}(),angular.element(document).ready(function(){angular.module(MyAppConfig.name).run(["$rootScope","$log",function(e,o){o.info("模块初始化。。。",MyAppConfig),e.AppTitle=MyAppConfig.title}]),angular.bootstrap(document,[MyAppConfig.name])});